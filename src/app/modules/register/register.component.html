<main class="page">
  <section class="card">
    <header class="header">
      <div>
        <h2>Create Account</h2>
        <p>Your account will be pending until admin approval.</p>
      </div>

      <!-- ✅ do not access router directly in template -->
      <button type="button" class="btn ghost" (click)="goBack()">Back</button>
    </header>

    <form [formGroup]="form" (ngSubmit)="submit()" class="form">
      <div class="grid">
        <div class="field">
          <label>Full Name</label>
          <input type="text" formControlName="fullName" />
          <small class="error" *ngIf="f['fullName'].touched && f['fullName'].invalid">
            Full name is required.
          </small>
        </div>

        <div class="field">
          <label>Email</label>
          <input type="email" formControlName="email" />
          <small class="error" *ngIf="f['email'].touched && f['email'].invalid">
            Enter a valid email.
          </small>
        </div>

        <div class="field">
          <label>Password</label>
          <input
            [type]="showPassword ? 'text' : 'password'"
            formControlName="password"
            placeholder="Min 6 characters"
          />
          <small class="error" *ngIf="f['password'].touched && f['password'].invalid">
            Password must be at least 6 characters.
          </small>
        </div>

        <div class="field">
          <label>Confirm Password</label>
          <input
            [type]="showPassword ? 'text' : 'password'"
            formControlName="confirmPassword"
            placeholder="Re-enter password"
          />

          <!-- ✅ show mismatch only when confirm is touched AND mismatch error exists -->
          <small class="error"
            *ngIf="f['confirmPassword'].touched && form.hasError('passwordMismatch')">
            Passwords do not match.
          </small>
        </div>

        <div class="field">
          <label>Account Type</label>
          <select formControlName="roleId">
            <option [ngValue]="2">User</option>
            <option [ngValue]="1">Admin</option>
          </select>
          <small>Admin accounts require approval before use.</small>
        </div>
      </div>

      <footer class="actions">
        <button type="submit" class="btn primary" [disabled]="loading">
          {{ loading ? 'Creating...' : 'Create Account' }}
        </button>
      </footer>
    </form>
  </section>
</main>
